<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
  <style>
    body,html{
      height: 100%;
      width: 100%;
    }
    #map{
      height: 100%;
      width: 48%;
      display: inline-block;
      background-color: #000088;
    }
    #vid{
      height: 100%;
      width: 48%;
      display: inline-block;
      background-color: #008800;
    }
  </style>
</head>
<body>
<div id="map"></div>
<div id="imput"></div>
<div id="player"></div>

<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
<script src=""></script>
<script src="http://maps.google.com/maps/api/js?v=3&amp;sensor=false"></script>
<script src="scripts/MdlGMap.js" ></script>
<script src="scripts/gmapLayerline.js"></script>
<script src="scripts/gmapMarkerMoveRotateUni.js"></script>
<script src="scripts/MdlYoutube.js"></script>
<script src="scripts/MdlYoutubeMap.js"></script>

<script>
  /*
  * Binary search in JavaScript.
  * Returns the index of of the element in a sorted array or (-n-1) where n is the insertion point for the new element.
  * Parameters:
  *     ar - A sorted array
  *     el - An element to search for
  *     compare_fn - A comparator function. The function takes two arguments: (a, b) and returns:
  *        a negative number  if a is less than b;
  *        0 if a is equal to b;
  *        a positive number of a is greater than b.
  * The array may contain duplicate elements. If there are more than one equal elements in the array,
  * the returned value can be the index of any one of the equal elements.
  */
  function binarySearch(ar, el, compare_fn) {
    var m = 0;
    var n = ar.length - 1;
    while (m <= n) {
      var k = (n + m) >> 1;
      //console.info(m,n,k);
      var cmp = compare_fn(el, ar[k]);
      if (cmp > 0) {
        m = k + 1;
      } else if(cmp < 0) {
        n = k - 1;
      } else {
        return k;
      }
    }
    return m-1;
  }

  function convert(texto){
    texto = texto.replace(",",".");
    return parseFloat(texto);
  }

  function converLabel(milisegundos){
    var sec = parseInt(milisegundos/1000);

    var min = parseInt(sec/60);
    //console.info(min,sec);
    sec = sec-(min*60);

    return ""+min+"."+sec;

  }



  function createInput(traclen){
    var newInput = document.createElement("input");
    newInput.type="range";
    newInput.name="trackRange";
    newInput.id="trackRange";
    newInput.min=0;
    newInput.max=traclen;
    document.getElementById('imput').appendChild(newInput);
    $(newInput).change(function(event){
      console.info(event);
      var value = event.currentTarget.value;
      console.info(value);
      MdlYoutubeMap.goToVideoTimeByTrack(value);
    });
  }


  var success = function (data) {
    var vidid = data.vid;
    var trackdata = data.RECORDS;
    var delay = data.dly;
    var optVideo = {
      width: 400,

      height: 300
    };
    var icon = {

      url: "images/drone.png",

      width: 40,

      height: 40

    };
    MdlYoutubeMap.load(trackdata,vidid,delay,optVideo,icon);

    createInput(MdlYoutubeMap.getTrackLen());
  };



  $.ajax({
    //type: "POST",
    dataType: "json",
    //url: "data/combustible_point10.json",
    contentType: "application/json; chartset:utf-8",
    url: "data/reportelogvideodelay.json",
    data: {},
    success: success,
    error: function (error) {
      console.error(error);
    },
    async: true

  });

</script>
</body>
</html>
