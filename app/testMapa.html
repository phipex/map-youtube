<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
  <style>
    body,html{
      height: 100%;
      width: 100%;
    }
    #map{
      height: 100%;
      width: 100%;

    }

  </style>

</head>
<body>
<div id="map"></div>
<script src="../bower_components/jquery/dist/jquery.min.js"></script>
<script src="../bower_components/openlayers/lib/OpenLayers.js"></script>
<script src="scripts/gmapolLayerReportes.js"></script>
<script src="scripts/gmapolLayerlineArrow.js"></script>
<script>
  var map;
  function init(){
    map = new OpenLayers.Map('map');
    var base = new OpenLayers.Layer.WMS(
      "Gisco Maps",
      "http://66.228.127.2:8383/geoserver/gwc/service/wms?",
      //"GiscoMaps/?",
      { layers: 'roads_col:colombia_compl', srs: 'EPSG:4326' },
      { numZoomLevels: 21, attribution: '<img src=\"http://www.mygisco.com/catalogo/gisco_logo.png\" width=\"105\" height=\"75\" alt=\".::GISCO::.\">' }
    );
    map.addLayers([base]);
    map.addControl(new OpenLayers.Control.MousePosition());
    map.addControl(new OpenLayers.Control.Attribution());
    //map.addControl(new OpenLayers.Control.PanZoomBar());

    map.addControl(new OpenLayers.Control.OverviewMap());
    map.addControl(new OpenLayers.Control.LayerSwitcher());
    map.setCenter(new OpenLayers.LonLat( - 75.56889, 6.232323), 8);
    //map.events.register("zoomend", map, eventoCambioZoom);
    //refrescarUltimo();
  }

  init();

function success(data){
  console.info(data);
  var layerrepo = new LayerReportes();

  $(data.RECORDS).each(function(index,item){
    console.info(item);
    var lat = convert(item.lat);
    var lon = convert(item.lon);
    var angule = parseInt(item.hea);
    var label = "";
    var divname = "";
    layerrepo.addPoint(lat,lon,angule,label,divname);

  });
  layerrepo.drawReporte(map,"primero",function(a,b,c){
    console.info(a,b,c);
  });
}

  function convert(texto){
    texto = texto.replace(",",".");
    return parseFloat(texto);
  }

  $.ajax({
    //type: "POST",
    dataType: "json",
    //url: "data/combustible_point10.json",
    contentType: "application/json; chartset:utf-8",
    url: "data/reportelog.json",
    data: {},
    success: success,
    error: function (error) {
      console.error(error);
    },
    async: true
  });

</script>

</body>
</html>
